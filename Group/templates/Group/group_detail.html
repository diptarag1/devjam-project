{% extends "base.html" %}
{% block left %}
<div class="content-section">
  <h3>Channels</h3>
  <p class='text-muted'>Placeholder Text</p>
    <ul class="list-group">
      {% if user.is_authenticated%}
          <li class="list-group-item list-group-item-light"> <h5 align = "center" ><a href = "{% url 'post-create' %}"> Create Group Post </a> </h5></li>
        {% endif %}
        {% for c in channels %}
          <li class="list-group-item list-group-item-light"> <a href = "{% url 'group-detail' slug=group.title activechannel=c.name %}"> <p> {{c.name}} </p></a> </li>
        {% endfor %}
    </ul>
</div>
{% endblock %}
{%block content%}
<h1>{{group.title}}</h1>
<h2>description:{{group.description}}</h2>
<h3>Members Count:{{countmem.count}}</h3>
{% for mem in gmember %}
{% if mem.status == 1 and cgmember.auth < 2%}
<h3>{{mem.user.username}}:<a href="{% url 'reject' slug=group.title userd=mem.user %}">Remove</a></h3>
{% elif mem.status == 1 %}
<h3>{{mem.user}}</h3>
{% endif %}
{% endfor %}
{% if not user in group.members.all %}
<a href="{%url 'addmember' slug=group.title%}"><button type="button" name="button">Join</button></a>
{% elif user in group.members.all and cgmember.status == 0 %}
<h3>Your application is Pending!!</h3>
{% else %}
<a href="{%url 'addmember' slug=group.title%}"><button type="button" name="button">Leave</button></a>
{% endif %}

{% if cgmember.auth < 2 %}
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter">
  Request List
</button>
{% endif %}

<br><br>
{% for post in posts %}
<article class="media content-section">
      <img class = "rounded-circle article-img" src = "{{post.author.profile.image.url}}">
<div class="media-body">
  <div class="article-metadata">
    <a class="mr-2" href="{% url 'profile' slug=post.author.username %}">{{ post.author }}</a>
    <small class="text-muted">{{ post.date_posted }}</small>
  </div>
{% if not user in post.views.all %}
  <u><h2><a class="article-title" href="{% url 'post-detail' post.id %}">{{ post.title }}</a></h2></u>
{% else %}
<h2><a class="article-title" href="{% url 'post-detail' post.id %}">{{ post.title }}</a></h2>
{% endif %}
  <p>
    {% for tag in post.tags.all %}
    <a href = "{% url 'explore-tag' tag %}"> #{{tag}} </a>
    {% endfor %}
  </p>
</div>
</article>
{% endfor %}


<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Pending List</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
          {% for mem in gmember %}
          {% if  mem.status == 0 %}
          <li>
              <ul>
                   {{mem.user.username}}:<a href="{% url 'accept' slug=group.title userd=mem.user %}">Accept</a>/<a href="{% url 'reject' slug=group.title userd=mem.user %}">Reject</a>
              </ul>

          </li>
          {%endif%}
          {%endfor%}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>
{%endblock%}
{% url 'profile' slug=user.username %}
